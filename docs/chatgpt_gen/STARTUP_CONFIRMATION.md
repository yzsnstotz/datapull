# DriveQuiz API æœåŠ¡å¯åŠ¨ç¡®è®¤æŠ¥å‘Š

**å¯åŠ¨æ—¶é—´**ï¼š2025-01-XX  
**æœåŠ¡ç‰ˆæœ¬**ï¼šv1.1.0  
**è¿è¡Œç¯å¢ƒ**ï¼šdevelopment

---

## âœ… æœåŠ¡å¯åŠ¨çŠ¶æ€

### å¯åŠ¨æ—¥å¿—

```
{"level":"info","time":1762511420012,"pid":39047,"hostname":"Leos-Air.lan","event":"server.started","port":8789,"host":"0.0.0.0","version":"1.1.0","env":"development"}
```

**çŠ¶æ€**ï¼šâœ… **æœåŠ¡å·²æˆåŠŸå¯åŠ¨**

---

## ğŸ“‹ æœåŠ¡ä¿¡æ¯

### åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | å€¼ | çŠ¶æ€ |
|------|-----|------|
| **æœåŠ¡åç§°** | DriveQuiz API | âœ… |
| **ç‰ˆæœ¬** | v1.1.0 | âœ… |
| **è¿è¡Œç¯å¢ƒ** | development | âœ… |
| **è¿›ç¨‹ ID** | 39047 | âœ… |
| **ä¸»æœºå** | Leos-Air.lan | âœ… |

### ç½‘ç»œé…ç½®

| é…ç½®é¡¹ | å€¼ | è¯´æ˜ |
|--------|-----|------|
| **ç›‘å¬åœ°å€** | `0.0.0.0` | å…è®¸æ‰€æœ‰ç½‘ç»œæ¥å£è®¿é—® |
| **ç«¯å£** | `8789` | âœ… å·²é¿å…ä¸ local-ai-service (8788) å†²çª |
| **æœ¬åœ°åœ°å€** | `http://127.0.0.1:8789` | æœ¬åœ°å›ç¯åœ°å€ |
| **å±€åŸŸç½‘åœ°å€** | `http://192.168.100.48:8789` | å±€åŸŸç½‘è®¿é—®åœ°å€ |
| **å…¶ä»–åœ°å€** | `http://100.118.180.4:8789` | å…¶ä»–ç½‘ç»œæ¥å£ |

---

## ğŸ” å¥åº·æ£€æŸ¥æµ‹è¯•

### æµ‹è¯•ç»“æœ

**è¯·æ±‚**ï¼š
```bash
curl http://localhost:8789/api/v1/rag/health
```

**å“åº”**ï¼š
```json
{
  "status": "ok",
  "timestamp": "2025-11-07T10:30:58.982Z",
  "version": "v1.1"
}
```

**çŠ¶æ€**ï¼šâœ… **å¥åº·æ£€æŸ¥é€šè¿‡**

---

## ğŸ“ API ç«¯ç‚¹

### åŸºç¡€è·¯å¾„

- **æœ¬åœ°è®¿é—®**ï¼š`http://localhost:8789/api/v1/rag`
- **å±€åŸŸç½‘è®¿é—®**ï¼š`http://192.168.100.48:8789/api/v1/rag`
- **å¥åº·æ£€æŸ¥**ï¼š`http://localhost:8789/api/v1/rag/health`

### å¯ç”¨æ¥å£

1. **å¥åº·æ£€æŸ¥**
   - `GET /api/v1/rag/health`
   - âœ… å·²éªŒè¯å¯ç”¨

2. **å•æ–‡æ¡£ä¸Šä¼ **
   - `POST /api/v1/rag/docs`
   - éœ€è¦ Bearer Token è®¤è¯

3. **æ‰¹é‡æ–‡æ¡£ä¸Šä¼ **
   - `POST /api/v1/rag/docs/batch`
   - éœ€è¦ Bearer Token è®¤è¯

4. **æŸ¥è¯¢æ“ä½œè®°å½•åˆ—è¡¨**
   - `GET /api/v1/rag/operations`
   - éœ€è¦ Bearer Token è®¤è¯

5. **æŸ¥è¯¢æ“ä½œè¯¦æƒ…**
   - `GET /api/v1/rag/operations/:operationId`
   - éœ€è¦ Bearer Token è®¤è¯

---

## âœ… é…ç½®éªŒè¯

### ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡ | çŠ¶æ€ | å€¼ï¼ˆéƒ¨åˆ†éšè—ï¼‰ |
|---------|------|---------------|
| `DRIVEQUIZ_API_TOKEN_SECRET` | âœ… | `drivequiz-api-secret-token-...` |
| `DRIVEQUIZ_DB_URL` | âœ… | `postgresql://postgres:***@db.cgpmpfnjzlzbakmmrj.supabase.co:5432/postgres?sslmode=require` |
| `AI_VECTORIZE_URL` | âœ… | `http://localhost:8787/v1/admin/rag/ingest` |
| `PORT` | âœ… | `8789` |
| `HOST` | âœ… | `0.0.0.0` |
| `RAG_ENABLE_SERVER_CHUNK` | âœ… | `false` |
| `MAX_BATCH_SIZE` | âœ… | `100` |
| `LOG_LEVEL` | âœ… | `info` |
| `NODE_ENV` | âœ… | `development` |

**ç»“è®º**ï¼šâœ… æ‰€æœ‰ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

---

## ğŸ”— æœåŠ¡ä¾èµ–

### å‘é‡åŒ–æœåŠ¡

- **åœ°å€**ï¼š`http://localhost:8787/v1/admin/rag/ingest`
- **æœåŠ¡**ï¼šai-service
- **çŠ¶æ€**ï¼šéœ€è¦ç¡®è®¤ ai-service æ˜¯å¦è¿è¡Œ

### æ•°æ®åº“

- **æ•°æ®åº“**ï¼šAI Service æ•°æ®åº“ï¼ˆ`cgpmpfnjzlzbakmmrj`ï¼‰
- **çŠ¶æ€**ï¼šå·²é…ç½®è¿æ¥å­—ç¬¦ä¸²
- **è¡¨**ï¼š`rag_documents`ã€`rag_operations`ã€`rag_operation_documents`

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

### 1. å¥åº·æ£€æŸ¥

```bash
curl http://localhost:8789/api/v1/rag/health
```

**æœŸæœ›å“åº”**ï¼š
```json
{
  "status": "ok",
  "timestamp": "2025-11-07T10:30:58.982Z",
  "version": "v1.1"
}
```

### 2. æµ‹è¯•è®¤è¯ï¼ˆåº”è¿”å› 401ï¼‰

```bash
curl -X POST http://localhost:8789/api/v1/rag/docs \
  -H "Content-Type: application/json" \
  -d '{"test": "data"}'
```

**æœŸæœ›å“åº”**ï¼š
```json
{
  "success": false,
  "error": {
    "code": "UNAUTHORIZED",
    "message": "Invalid or missing token"
  }
}
```

---

## ğŸ“Š æœåŠ¡çŠ¶æ€æ€»ç»“

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| **æœåŠ¡å¯åŠ¨** | âœ… | å·²æˆåŠŸå¯åŠ¨ |
| **ç«¯å£é…ç½®** | âœ… | ç«¯å£ 8789ï¼Œæ— å†²çª |
| **å¥åº·æ£€æŸ¥** | âœ… | æ¥å£æ­£å¸¸å“åº” |
| **ç¯å¢ƒå˜é‡** | âœ… | æ‰€æœ‰å¿…éœ€å˜é‡å·²é…ç½® |
| **ç½‘ç»œç›‘å¬** | âœ… | ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ |
| **ç‰ˆæœ¬ä¿¡æ¯** | âœ… | v1.1.0 |

---

## âœ… ç»“è®º

**æœåŠ¡å¯åŠ¨çŠ¶æ€**ï¼šâœ… **æ­£å¸¸**

DriveQuiz API æœåŠ¡å·²æˆåŠŸå¯åŠ¨å¹¶è¿è¡Œåœ¨ç«¯å£ 8789 ä¸Šã€‚æ‰€æœ‰é…ç½®æ­£ç¡®ï¼Œå¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸å“åº”ã€‚

### ä¸‹ä¸€æ­¥æ“ä½œ

1. âœ… æœåŠ¡å·²å¯åŠ¨
2. â­ï¸ æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼ˆå¦‚æœªæ‰§è¡Œï¼‰ï¼š
   ```bash
   npm run db:migrate
   ```
3. â­ï¸ æµ‹è¯• API æ¥å£ï¼ˆéœ€è¦ Bearer Tokenï¼‰ï¼š
   ```bash
   curl -X POST http://localhost:8789/api/v1/rag/docs \
     -H "Authorization: Bearer <TOKEN>" \
     -H "Content-Type: application/json" \
     -d '{...}'
   ```

---

**ç¡®è®¤æ—¶é—´**ï¼š2025-01-XX  
**ç¡®è®¤çŠ¶æ€**ï¼šâœ… æœåŠ¡æ­£å¸¸è¿è¡Œ

